<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Refluxmanifesto by bunniesandbeatings</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Refluxmanifesto</h1>
      <h2 class="project-tagline">Thoughts on using Reflux as I try to come to terms with it</h2>
      <a href="https://github.com/bunniesandbeatings/RefluxManifesto" class="btn">View on GitHub</a>
      <a href="https://github.com/bunniesandbeatings/RefluxManifesto/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/bunniesandbeatings/RefluxManifesto/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="reflux-manifesto" class="anchor" href="#reflux-manifesto" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reflux Manifesto</h1>

<p>Thoughts on using Reflux as I try to come to terms with it.</p>

<h2>
<a id="actions" class="anchor" href="#actions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Actions:</h2>

<ul>
<li>
<a href="#new-data">New Data</a> <strong>always</strong> enters through actions</li>
<li>Actions represent one half of the <a href="#public-api">Public API</a> of your business domain.</li>
<li>Actions do no modelling, Stores do.

<ul>
<li>Don't read state from a store, that sounds like we're mixing business logic in actions.</li>
<li>Don't respond to the payload from components, that's also business logic.</li>
</ul>
</li>
<li>Do not listen to stores (although stores can trigger actions)</li>
</ul>

<h2>
<a id="stores" class="anchor" href="#stores" aria-hidden="true"><span class="octicon octicon-link"></span></a>Stores:</h2>

<ul>
<li>Where the business domain model belongs</li>
<li>Can have direct method calls from other business modelling (other stores)</li>
<li>Can contain <a href="#state">state</a> that matters for business domain modelling

<ul>
<li>Don't put everything in here. Just the stuff you need to persist for business decisions. </li>
</ul>
</li>
<li>Stores can be dependent on <a href="https://github.com/spoike/refluxjs#joining-parallel-listeners-with-composed-listenables">multiple events occuring</a>

<ul>
<li>from actions</li>
<li>from other stores</li>
</ul>
</li>
<li>
<a href="#shared-modelling">Shared modelling</a> should be composed into mixins</li>
<li>Emit events so that views and other stores can react to changes.</li>
<li>Emit action events so that other dataflows can be triggered. <a href="#stores-triggering-actions">I have some concerns</a>
</li>
</ul>

<h2>
<a id="components" class="anchor" href="#components" aria-hidden="true"><span class="octicon octicon-link"></span></a>Components:</h2>

<ul>
<li>Are dumb or smart</li>
<li>Smart == ViewController

<ul>
<li>Map view events to Actions</li>
<li>Call Actions during component lifecycle - e.g. componentWillMount</li>
<li>Map Store Events to setState, causing invalidation</li>
</ul>
</li>
<li>Dumb == Business Domain Free components, they talk about UI things, not business things

<ul>
<li>Know nothing of your Actions or stores</li>
<li>Are mutated via parent 'ViewControllers' setting proprties or state.</li>
</ul>
</li>
</ul>

<h1>
<a id="notes" class="anchor" href="#notes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Notes</h1>

<h2>
<a id="new-data" class="anchor" href="#new-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>New Data</h2>

<p>New data can:</p>

<ul>
<li>Result from user actions</li>
<li>Result from service results</li>
<li>Result from domain changes (eg the hashchange event)</li>
</ul>

<p>Even without new data, if the view wants state to change (eg SomeThing.toggleSelected), do so through actions.</p>

<h2>
<a id="public-api" class="anchor" href="#public-api" aria-hidden="true"><span class="octicon octicon-link"></span></a>Public API</h2>

<p>Your business domain get's a clear public API comprised of:</p>

<ul>
<li>Actions: which are the only cause for state mutation.</li>
<li>Store Events: which allow ViewControllers to respond to changes in state</li>
<li>Store State: Which allows views to refresh based on state regardless of wether store events occured</li>
</ul>

<p>I'm not sure about reading state from the stores. It might be possible to avoid using it in views, and keep the interface very narrow indeed.</p>

<h2>
<a id="shared-modelling" class="anchor" href="#shared-modelling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Shared Modelling</h2>

<p>From <a href="https://github.com/spoike/refluxjs/issues/252">An Issue</a> where Spoike discusses typical store-&gt;component updates and shared behaviour.</p>

<blockquote>
<p><code>trigger</code> passes the arguments over to the listeners... and I personally prefer to pass all the data that the components need through the event. I have passed the store itself (for quick prototype hacks) and use setters and getters. Both approaches are equal valid implementations and I don't want to enforce one over the other.</p>

<p>However I don't personally encourage the latter approach (of setters and getters on the store) since that usually has been a slipper slope to create stores that are "god classes". "God class" or "big ball of mud" are anti-patterns that I like to avoid.</p>

<p>As to how to reuse, I use mixins when applicable. If you think about them as traits, it makes it easy to attach functionality that you may want to reuse. If you need to add common methods to all stores you may add them to the <code>Reflux.StoreMixin</code> which is used during creation of stores.</p>
</blockquote>

<h2>
<a id="state" class="anchor" href="#state" aria-hidden="true"><span class="octicon octicon-link"></span></a>State</h2>

<p>Spoike suggests:</p>

<blockquote>
<blockquote>
<p>As far as Flux goes is it okay to store the global var map = Object instance inside a store as a plain JS variable and then have a getter/setter action to get that map instance across multiple components in my app, including Maps component itself?</p>
</blockquote>

<p>Sure, if that works for you then it is okay. Stores are supposed to hold all the data that the components need between each other.</p>
</blockquote>

<p>I'm of the opinion that you would try to avoid storing a whole map component (google map object), and have a controller view share it's state with the business model through busines-centric actions. This way you find yourself modelling your domain, not Googles. </p>

<h2>
<a id="stores-triggering-actions" class="anchor" href="#stores-triggering-actions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Stores triggering actions</h2>

<p>This one seems like it could become hard to reason about.</p>

<p>My concern is that this would introduce an action that:</p>

<ul>
<li>is triggered without new information being introduced into the business modelling</li>
<li>is possibly only a 'sub-flow' of the public API, making it something that views would never directly consume, ergo, not a Public API</li>
</ul>

<p>I want to use these, they seem valuable.</p>

<p><a href="https://github.com/spoike/refluxjs/issues/158#issuecomment-67444098">There is a discussion here</a></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/bunniesandbeatings/RefluxManifesto">Refluxmanifesto</a> is maintained by <a href="https://github.com/bunniesandbeatings">bunniesandbeatings</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

